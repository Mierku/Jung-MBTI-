# MBTI 性格测试小程序

## 云开发配置指南

为了启用小程序码生成功能，需要配置微信云开发环境。请按照以下步骤操作：

### 1. 开通云开发环境

1. 打开微信开发者工具，导入项目
2. 点击工具栏中的"云开发"
3. 如果是首次使用，请点击"开通"，按照指引创建一个新的云环境
4. 记录您的云环境 ID，例如：`mbti-test-123456`

### 2. 配置云函数

本项目已经包含了一个`getQRCode`云函数，用于生成小程序码。需要上传并部署：

1. 在微信开发者工具中，右键点击`cloudfunctions/getQRCode`文件夹
2. 选择"上传并部署：云端安装依赖"
3. 等待部署完成

### 3. 启用云函数获取小程序码

1. 打开`miniprogram/pages/result/result.js`文件
2. 查找以下注释段落：

```js
// ==================================================
// 云函数获取小程序码的代码 - 配置云环境后取消注释使用
// ==================================================
```

3. 将注释代码取消注释（移除包裹代码的`/*`和`*/`）
4. 同时，将上方的"临时占位代码"注释掉

### 4. 权限处理

小程序需要申请相册写入权限才能保存分享图片。该权限会在用户首次使用分享功能时自动请求：

1. 当用户点击"生成分享图片"时，会自动弹出权限申请弹窗
2. 如果用户拒绝授权，会提示用户前往设置页面开启权限

注意：微信规定，任何敏感权限都必须在用户主动触发的操作中申请，不能在启动时自动申请。

### 5. 设置安全域名

如果小程序需要发布，还需要在微信公众平台后台配置以下域名：

1. 登录微信公众平台
2. 进入"开发"->"开发设置"
3. 在"服务器域名"中添加云存储域名到 downloadFile 合法域名中

## 小程序发布前检查项

发布小程序前，请完成以下检查：

1. 云开发环境已正确配置
2. 小程序码生成功能已测试通过
3. 所有页面在不同尺寸设备上显示正常
4. 测试所有功能路径是否正常工作
5. 图片资源加载速度是否合理
6. 分享功能是否按预期工作

## 项目结构

- `miniprogram/`: 小程序源代码
- `cloudfunctions/`: 云函数代码

## 功能特点

- MBTI 人格测试
- 认知功能分析
- 生成分享图片（含小程序码）
- 类型详细解析

## 开发技术

- 微信小程序原生开发
- 微信云开发
- Canvas 图形处理
